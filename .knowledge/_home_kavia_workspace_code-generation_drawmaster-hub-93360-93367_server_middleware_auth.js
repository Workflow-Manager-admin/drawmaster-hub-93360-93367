{"is_source_file": true, "format": "JavaScript", "description": "This file defines middleware functions for authentication and authorization in an Express.js server. It includes functions to protect routes by verifying JWT tokens and to authorize users based on their roles.", "external_files": ["../models/User"], "external_methods": ["jwt.verify", "User.findById"], "published": ["exports.protect", "exports.authorize"], "classes": [], "methods": [{"name": "protect", "description": "Middleware function to verify JWT token from request headers, authenticate the user, and attach the user object to the request."}, {"name": "authorize", "description": "Middleware factory function that grants access to routes based on user roles."}], "calls": ["jwt.verify", "User.findById"], "search-terms": ["auth middleware", "JWT token verification", "role-based authorization", "protect routes", "Express.js authentication"], "state": 2, "file_id": 23, "knowledge_revision": 48, "git_revision": "22b00c3e310c5c28f894acd9a992cd493f54f707", "ctags": [{"_type": "tag", "name": "User", "path": "/home/kavia/workspace/code-generation/drawmaster-hub-93360-93367/server/middleware/auth.js", "pattern": "/^const User = require('..\\/models\\/User');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "decoded", "path": "/home/kavia/workspace/code-generation/drawmaster-hub-93360-93367/server/middleware/auth.js", "pattern": "/^    const decoded = jwt.verify(token, process.env.JWT_SECRET);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "jwt", "path": "/home/kavia/workspace/code-generation/drawmaster-hub-93360-93367/server/middleware/auth.js", "pattern": "/^const jwt = require('jsonwebtoken');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/drawmaster-hub-93360-93367/server/middleware/auth.js", "pattern": "/^  let token;$/", "language": "JavaScript", "kind": "variable"}], "filename": "/home/kavia/workspace/code-generation/drawmaster-hub-93360-93367/server/middleware/auth.js", "hash": "73b350eb4bd75c750cd2cf1026fcd6bc", "format-version": 4, "code-base-name": "default", "fields": [{"name": "let token;", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"48": "22b00c3e310c5c28f894acd9a992cd493f54f707"}]}